<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>전체 현황 모니터</title>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

<script>
  // Firebase 설정
  const firebaseConfig = {
    apiKey: "AIzaSyA9r1CfIRz9eWk9FHQyCjDPrjbtx1q-slE",
    authDomain: "produccion-monitoreo.firebaseapp.com",
    databaseURL: "https://produccion-monitoreo-default-rtdb.firebaseio.com",
    projectId: "produccion-monitoreo",
    storageBucket: "produccion-monitoreo.firebasestorage.app",
    messagingSenderId: "563946409671",
    appId: "1:563946409671:web:9b5a85422938b8e95478e2",
    measurementId: "G-NSD6K7WTLZ"
  };

  // Firebase 초기화
  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();
</script>
  <style>
    body { font-family: Arial, sans-serif; margin: 40px; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
    th { background-color: #f2f2f2; }
    .header { font-size: 24px; font-weight: bold; }
    button { margin-top: 10px; padding: 8px 16px; }
  </style>
</head>
<body>
  <div class="header">전체 사용자 작업 현황</div>

  <table>
    <thead>
      <tr>
        <th>#</th>
        <th>이름</th>
        <th>라인</th>
        <th>스타일</th>
        <th>개수</th>
        <th>등록시간</th>
      </tr>
    </thead>
    <tbody id="dataTable">
      <!-- 데이터 자동 삽입 -->
    </tbody>
  </table>

  <button onclick="clearAll()">모든 기록 삭제</button>
  <button onclick="exportToExcel()">📥 엑셀로 다운로드</button>

  <script>
    function loadData() {
      const dataTable = document.getElementById("dataTable");
      dataTable.innerHTML = "";

      // 모든 작업 내역 가져오기
      const allData = JSON.parse(localStorage.getItem("workRecords")) || [];

      allData.forEach((record, index) => {
        const row = document.createElement("tr");
        row.innerHTML = `
          <td>${index + 1}</td>
          <td>${record.name}</td>
          <td>Line ${record.line}</td>
          <td>${record.style}</td>
          <td>${record.quantity}</td>
          <td>${record.timestamp}</td>
        `;
        dataTable.appendChild(row);
      });
    }

    function clearAll() {
      if (confirm("정말 모든 데이터를 삭제하시겠습니까?")) {
        localStorage.removeItem("workRecords");
        loadData();
      }
    }
     function exportToExcel() {
      const table = document.getElementById("dataTable");
      const wb = XLSX.utils.table_to_book(table, { sheet: "작업현황" });
      XLSX.writeFile(wb, "작업현황.xlsx");
    }

    loadData();
  </script>
</body>
</html>
