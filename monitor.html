<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ì „ì²´ í˜„í™© ëª¨ë‹ˆí„°</title>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

<script>
  // Firebase ì„¤ì •
  const firebaseConfig = {
    apiKey: "AIzaSyA9r1CfIRz9eWk9FHQyCjDPrjbtx1q-slE",
    authDomain: "produccion-monitoreo.firebaseapp.com",
    databaseURL: "https://produccion-monitoreo-default-rtdb.firebaseio.com",
    projectId: "produccion-monitoreo",
    storageBucket: "produccion-monitoreo.firebasestorage.app",
    messagingSenderId: "563946409671",
    appId: "1:563946409671:web:9b5a85422938b8e95478e2",
    measurementId: "G-NSD6K7WTLZ"
  };

  // Firebase ì´ˆê¸°í™”
  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();
</script>
  <style>
    body { font-family: Arial, sans-serif; margin: 40px; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
    th { background-color: #f2f2f2; }
    .header { font-size: 24px; font-weight: bold; }
    button { margin-top: 10px; padding: 8px 16px; }
  </style>
</head>
<body>
  <div class="header">ì „ì²´ ì‚¬ìš©ì ì‘ì—… í˜„í™©</div>

  <table>
    <thead>
      <tr>
        <th>#</th>
        <th>ì´ë¦„</th>
        <th>ë¼ì¸</th>
        <th>ìŠ¤íƒ€ì¼</th>
        <th>ê°œìˆ˜</th>
        <th>ë“±ë¡ì‹œê°„</th>
      </tr>
    </thead>
    <tbody id="dataTable">
      <!-- ë°ì´í„° ìë™ ì‚½ì… -->
    </tbody>
  </table>

  <button onclick="clearAll()">ëª¨ë“  ê¸°ë¡ ì‚­ì œ</button>
  <button onclick="exportToExcel()">ğŸ“¥ ì—‘ì…€ë¡œ ë‹¤ìš´ë¡œë“œ</button>

  <script>
    function loadData() {
      const dataTable = document.getElementById("dataTable");
      dataTable.innerHTML = "";

      // ëª¨ë“  ì‘ì—… ë‚´ì—­ ê°€ì ¸ì˜¤ê¸°
      const allData = JSON.parse(localStorage.getItem("workRecords")) || [];

      allData.forEach((record, index) => {
        const row = document.createElement("tr");
        row.innerHTML = `
          <td>${index + 1}</td>
          <td>${record.name}</td>
          <td>Line ${record.line}</td>
          <td>${record.style}</td>
          <td>${record.quantity}</td>
          <td>${record.timestamp}</td>
        `;
        dataTable.appendChild(row);
      });
    }

    function clearAll() {
      if (confirm("ì •ë§ ëª¨ë“  ë°ì´í„°ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
        localStorage.removeItem("workRecords");
        loadData();
      }
    }
     function exportToExcel() {
      const table = document.getElementById("dataTable");
      const wb = XLSX.utils.table_to_book(table, { sheet: "ì‘ì—…í˜„í™©" });
      XLSX.writeFile(wb, "ì‘ì—…í˜„í™©.xlsx");
    }

    loadData();
  </script>
</body>
</html>
