<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>작업 등록</title>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js"></script>

<script>
  // Firebase 설정
  const firebaseConfig = {
    apiKey: "AIzaSyA9r1CfIRz9eWk9FHQyCjDPrjbtx1q-slE",
    authDomain: "produccion-monitoreo.firebaseapp.com",
    databaseURL: "https://produccion-monitoreo-default-rtdb.firebaseio.com",
    projectId: "produccion-monitoreo",
    storageBucket: "produccion-monitoreo.firebasestorage.app",
    messagingSenderId: "563946409671",
    appId: "1:563946409671:web:9b5a85422938b8e95478e2",
    measurementId: "G-NSD6K7WTLZ"
  };

  // Firebase 초기화
  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();
</script>
  <style>
    body { font-family: Arial, sans-serif; max-width: 500px; margin: 50px auto; }
    label, input, button { display: block; width: 100%; margin-top: 10px; padding: 10px; }
    button { background: #2196F3; color: white; border: none; cursor: pointer; }
    .result { margin-top: 20px; background: #f1f1f1; padding: 15px; border-radius: 5px; }
    .checkbox-grid {
      display: grid;
      grid-template-columns: repeat(5, 1fr); /* 가로 5칸 */
      gap: 10px;
      margin-top: 10px;
    }
    .checkbox-grid label {
      display: flex;
      align-items: center;
      font-size: 14px;
    }
  </style>
</head>
<body>
  <h2>작업 등록(Registador)</h2>
  <div id="userInfo"></div>

 <label>부위(Region):</label>
<div class="checkbox-grid">
  <label><input type="checkbox" name="style" value="Unir Hombro"> Unir Hombro</label>
  <label><input type="checkbox" name="style" value="Sorgele de Cuello"> Sorgele de Cuello</label>
  <label><input type="checkbox" name="style" value="Pega Manga"> Pega Manga</label>
  <label><input type="checkbox" name="style" value="Cerrar Coslado"> Cerrar Coslado</label>
  <label><input type="checkbox" name="style" value="Pega Cinta"> Pega Cinta</label>
  <label><input type="checkbox" name="style" value="S.l.c Cuello Reel"> S.l.c Cuello Reel</label>
  <label><input type="checkbox" name="style" value="lapa Cinta"> lapa Cinta</label>
  <label><input type="checkbox" name="style" value="Rl Cinta"> Rl Cinta</label>
  <label><input type="checkbox" name="style" value="Ruedo punto"> Ruedo punto</label>
  <label><input type="checkbox" name="style" value="Ruedo Palda"> Ruedo Palda</label>
</div>

<label>크기(Talla):</label>
<div class="checkbox-grid">
  <label><input type="checkbox" name="size" value="XS"> XS</label>
  <label><input type="checkbox" name="size" value="S"> S</label>
  <label><input type="checkbox" name="size" value="M"> M</label>
  <label><input type="checkbox" name="size" value="L"> L</label>
  <label><input type="checkbox" name="size" value="XL"> XL</label>
  <label><input type="checkbox" name="size" value="2XL"> 2XL</label>
  <label><input type="checkbox" name="size" value="3XL"> 3XL</label>
</div>

  <label for="quantity">개수(QTY):</label>
  <input type="number" id="quantity" min="1" placeholder="숫자 입력">

  <button onclick="submitWork()">완료(Completo)</button>

  <div class="result" id="result" style="display:none;"></div>

  <script>
function allowOnlyOne(name) {
    const checkboxes = document.querySelectorAll(`input[name="${name}"]`);
    checkboxes.forEach(cb => {
      cb.addEventListener('change', () => {
        if (cb.checked) {
          checkboxes.forEach(other => {
            if (other !== cb) other.checked = false;
          });
        }
      });
    });
  }

  // 부위(style), 크기(size)에 적용
  window.addEventListener('DOMContentLoaded', () => {
    allowOnlyOne('style');
    allowOnlyOne('size');
  });
    const user = JSON.parse(localStorage.getItem("currentUser"));
    if (!user) {
      alert("사용자 정보가 없습니다. 다시 등록해주세요.");
      window.location.href = "user_id.html";
    } else {
      document.getElementById("userInfo").innerHTML = `<strong>${user.name}</strong> (Line ${user.line})`;
    }

function submitWork() {
  const styleCheckbox = document.querySelector('input[name="style"]:checked');
  const sizeCheckbox = document.querySelector('input[name="size"]:checked');

  const style = styleCheckbox ? styleCheckbox.value : '';
  const size = sizeCheckbox ? sizeCheckbox.value : '';
  const quantity = document.getElementById("quantity").value;

  // 유효성 검사: 부위, 크기, 개수 모두 필수
  if (!style || !size || quantity <= 0) {
    alert("부위, 크기, 개수를 정확히 입력하세요.");
    return;
  }

  // 날짜 포맷: YYYY-MM-DD HH:MM:SS
  const now = new Date();
  const yyyy = now.getFullYear();
  const mm = String(now.getMonth() + 1).padStart(2, '0');
  const dd = String(now.getDate()).padStart(2, '0');
  const hh = String(now.getHours()).padStart(2, '0');
  const mi = String(now.getMinutes()).padStart(2, '0');
  const ss = String(now.getSeconds()).padStart(2, '0');
  const timestamp = `${yyyy}-${mm}-${dd} ${hh}:${mi}:${ss}`;  // ✅ 여기서 정의

  // 작업 내역 저장
  const allRecords = JSON.parse(localStorage.getItem("workRecords")) || [];
  allRecords.push({
    name: user.name,
    line: user.line,
    style,
    size,
    quantity,
    timestamp: timestamp  // ✅ 변수 이름 통일
  });
  localStorage.setItem("workRecords", JSON.stringify(allRecords));

  const resultDiv = document.getElementById("result");
  resultDiv.innerHTML = `
    <strong>작업 완료</strong><br>
    이름(nombre): ${user.name}<br>
    라인(linea): ${user.line}<br>
    부위(Region)): ${style}<br>
    크기(talla): ${size}<br>
    개수(QTY): ${quantity}<br>
    등록시간(Registar de tiempo): ${timestamp}
  `;
  resultDiv.style.display = "block";

  document.getElementById("style").value = "";
  document.getElementById("quantity").value = "";
}


  </script>
</body>
</html>
